<modified code from signal_generator.py>